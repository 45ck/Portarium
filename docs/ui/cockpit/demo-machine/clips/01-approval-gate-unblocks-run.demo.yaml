meta:
  title: 'Cockpit Demo: Approval Gate Unblocks Run'
  tags:
    - cockpit
    - governance
    - approvals
    - bead-0726

runner:
  command: 'npx --yes http-server docs/ui/cockpit -p 4174'
  url: 'http://localhost:4174'
  timeout: 20000

pacing:
  postClickDelayMs: 500
  postNavigateDelayMs: 900
  settleDelayMs: 250

chapters:
  - title: 'Precondition Reset'
    steps:
      - action: navigate
        url: 'http://localhost:4174/#inbox'
      - action: wait
        timeout: 1200
      - action: click
        selector: '#demoResetButton'
      - action: wait
        timeout: 600

  - title: 'Approve Gate'
    steps:
      - action: click
        selector: "[data-testid='demo-nav-approvals']"
      - action: wait
        timeout: 700
      - action: click
        selector: '#approvalDecision'
      - action: press
        key: 'ArrowDown'
      - action: press
        key: 'Enter'
      - action: wait
        timeout: 250
      - action: click
        selector: '#submitDecision'
      - action: wait
        timeout: 900

  - title: 'Verify Run Outcome'
    steps:
      - action: click
        selector: "[data-testid='demo-nav-runs']"
      - action: wait
        timeout: 700
      - action: assert
        selector: '#demoRunOutcomePreview'
      - action: screenshot
        name: 'approval-gate-unblocks-run'

  - title: 'Cleanup Reset'
    steps:
      - action: click
        selector: '#demoResetButton'
      - action: wait
        timeout: 500
