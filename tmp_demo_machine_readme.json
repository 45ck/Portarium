"<div align=\"center\">\n\n# demo-machine\n\n**Demo as code** — turn YAML specs into polished product demo videos.\n\n[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)\n[![Node.js](https://img.shields.io/badge/Node.js-%3E%3D22-339933?logo=node.js&logoColor=white)](https://nodejs.org)\n[![TypeScript](https://img.shields.io/badge/TypeScript-5.7-3178C6?logo=typescript&logoColor=white)](https://www.typescriptlang.org)\n[![Tests](https://img.shields.io/badge/Tests-172%20passing-brightgreen)](tests/)\n[![Playwright](https://img.shields.io/badge/Playwright-Browser%20Automation-2EAD33?logo=playwright&logoColor=white)](https://playwright.dev)\n[![FFmpeg](https://img.shields.io/badge/FFmpeg-Video%20Rendering-007808?logo=ffmpeg&logoColor=white)](https://ffmpeg.org)\n\nWrite a simple YAML file describing what to click, type, and navigate.<br>\ndemo-machine launches your app, drives a real browser with human-like interactions,<br>\nrecords everything, and renders a production-ready MP4.\n\n[Quick Start](#quick-start) &bull; [Spec Format](#spec-format) &bull; [CLI Reference](#usage) &bull; [Contributing](CONTRIBUTING.md)\n\n</div>\n\n---\n\n## Demo\n\n> A task manager app demo with voice narration — generated entirely from a [YAML spec](examples/todo-app.demo.yaml).\n\nhttps://github.com/45ck/demo-machine/raw/master/examples/todo-app-demo.mp4\n\nNotice the **smooth cursor movement** to each target, **character-by-character typing**, **voice narration** that leads into each action, and **polished overlays** with fades. This is not a screen recording — it's generated from code.\n\n<details>\n<summary><b>View the YAML spec that produced this video</b></summary>\n\n```yaml\nmeta:\n  title: \"TaskFlow - Task Manager Demo\"\n  resolution:\n    width: 1920\n    height: 1080\n\nrunner:\n  command: \"node examples/todo-app/serve.mjs\"\n  url: \"http://localhost:4567\"\n  timeout: 10000\n\nchapters:\n  - title: \"Welcome to TaskFlow\"\n    steps:\n      - action: navigate\n        url: \"http://localhost:4567\"\n        narration: \"Welcome to TaskFlow, a simple and elegant task manager.\"\n      - action: wait\n        timeout: 1000\n\n  - title: \"Getting Started\"\n    steps:\n      - action: click\n        selector: \"#get-started\"\n        narration: \"Let's click Get Started to begin managing our tasks.\"\n      - action: wait\n        timeout: 800\n\n  - title: \"Adding Tasks\"\n    steps:\n      - action: click\n        selector: \"#task-input\"\n      - action: type\n        selector: \"#task-input\"\n        text: \"Design new landing page\"\n        narration: \"We'll type in our first task — designing a new landing page.\"\n      - action: click\n        selector: \"#add-btn\"\n      - action: wait\n        timeout: 500\n      - action: type\n        selector: \"#task-input\"\n        text: \"Review pull requests\"\n        narration: \"Next, let's add a task to review pull requests.\"\n      - action: click\n        selector: \"#add-btn\"\n      - action: wait\n        timeout: 500\n      - action: type\n        selector: \"#task-input\"\n        text: \"Write unit tests\"\n        narration: \"And one more — writing unit tests.\"\n      - action: click\n        selector: \"#add-btn\"\n      - action: wait\n        timeout: 500\n\n  - title: \"Completing a Task\"\n    steps:\n      - action: click\n        selector: \".task-checkbox\"\n        narration: \"To mark a task as done, just click the checkbox.\"\n      - action: wait\n        timeout: 800\n\n  - title: \"Filtering Tasks\"\n    steps:\n      - action: click\n        selector: \"[data-filter='completed']\"\n        narration: \"We can filter to see only completed tasks.\"\n      - action: wait\n        timeout: 800\n      - action: click\n        selector: \"[data-filter='all']\"\n        narration: \"Or switch back to view all tasks at once.\"\n      - action: wait\n        timeout: 500\n```\n\n</details>\n\n## Why demo-machine?\n\nTools like Screen Studio and Arcade require manual recording sessions. Every time your UI changes, you re-record. demo-machine takes a different approach:\n\n- **Reproducible** — same YAML, same video, every time\n- **Version-controlled** — specs live in your repo, reviewable in PRs\n- **CI-friendly** — generate demo videos in your pipeline on every release\n- **No manual work** — no clicking through your app, no editing in a video tool\n\n## Features\n\n| Feature                   | Description                                                                 |\n| ------------------------- | --------------------------------------------------------------------------- |\n| **Smooth cursor**         | Cubic-bezier eased movement with click pulse feedback                       |\n| **Natural typing**        | Character-by-character keystroke simulation                                 |\n| **Configurable pacing**   | Global + per-step delays for clicks, typing, navigation                     |\n| **Polished overlays**     | Intro/outro cards, chapter titles with fades and backgrounds                |\n| **Auto app lifecycle**    | Spawns your dev server, healthchecks, tears down after                      |\n| **Redaction**             | Blur sensitive selectors, scan for secret patterns                          |\n| **Narration**             | Local TTS via Kokoro, or cloud via OpenAI/ElevenLabs with VTT/SRT subtitles |\n| **Dead-time compression** | Long pauses automatically sped up                                           |\n| **Callout zoom**          | Click targets highlighted with zoom regions                                 |\n\n## Quick Start\n\n### Prerequisites\n\n- [Node.js](https://nodejs.org) >= 22\n- [pnpm](https://pnpm.io)\n- [FFmpeg](https://ffmpeg.org) on your PATH\n- Playwright browsers: `pnpm exec playwright install chromium`\n\n### Install\n\n```bash\ngit clone https://github.com/45ck/demo-machine.git\ncd demo-machine\npnpm install\npnpm build\n```\n\n### Run the Example\n\n```bash\nnode dist/cli.js run examples/todo-app.demo.yaml \\\n  --output ./output \\\n  --no-headless\n```\n\nThis will:\n\n1. Start the included todo-app dev server\n2. Launch a browser with smooth cursor and natural typing\n3. Record the session via Playwright\n4. Render a polished MP4 with overlays to `./output/output.mp4`\n\n## Usage\n\n### CLI Commands\n\n```bash\n# Full pipeline: capture + edit + render\ndemo-machine run <spec.yaml>\n\n# Validate a spec file without running\ndemo-machine validate <spec.yaml>\n\n# Capture only (raw video, no post-processing)\ndemo-machine capture <spec.yaml>\n\n# Re-render from an existing event log\ndemo-machine edit <events.json>\n```\n\n### Options\n\n| Flag                    | Default    | Description                                    |\n| ----------------------- | ---------- | ---------------------------------------------- |\n| `-o, --output <dir>`    | `./output` | Output directory                               |\n| `--no-narration`        | —          | Skip TTS narration                             |\n| `--no-edit`             | —          | Raw capture only, skip rendering               |\n| `--no-headless`         | —          | Show the browser window                        |\n| `--renderer <name>`     | `ffmpeg`   | Video renderer                                 |\n| `--tts-provider <name>` | `kokoro`   | TTS: kokoro (local), openai, elevenlabs, piper |\n| `--verbose`             | —          | Debug logging                                  |\n\n## Spec Format\n\n### Minimal Spec\n\n```yaml\nmeta:\n  title: \"My Demo\"\n\nrunner:\n  url: \"http://localhost:3000\"\n\nchapters:\n  - title: \"Getting Started\"\n    steps:\n      - action: navigate\n        url: \"/\"\n      - action: click\n        selector: \"#btn\"\n```\n\n### Action Types\n\n| Action       | Required Fields    | Description                                     |\n| ------------ | ------------------ | ----------------------------------------------- |\n| `navigate`   | `url`              | Go to a URL                                     |\n| `click`      | `selector`         | Click an element                                |\n| `type`       | `selector`, `text` | Type text character-by-character                |\n| `hover`      | `selector`         | Hover over an element                           |\n| `scroll`     | —                  | Scroll the page (`selector`, `x`, `y` optional) |\n| `wait`       | `timeout`          | Pause for milliseconds                          |\n| `press`      | `key`              | Press a keyboard key                            |\n| `assert`     | `selector`         | Assert visibility or text content               |\n| `screenshot` | —                  | Take a screenshot (`name` optional)             |\n\nEvery action supports an optional `narration` field for TTS and most support `delay` to override the default post-action pause.\n\n### Pacing\n\nControl the feel of the demo globally. All fields are optional with sensible defaults:\n\n```yaml\npacing:\n  cursorDurationMs: 600 # cursor travel time\n  typeDelayMs: 50 # ms between keystrokes\n  postClickDelayMs: 500 # pause after clicks\n  postTypeDelayMs: 300 # pause after typing\n  postNavigateDelayMs: 1000 # pause after navigation\n  settleDelayMs: 200 # micro-pause after every action\n```\n\n### Redaction\n\nBlur sensitive content and scan for secret patterns:\n\n```yaml\nredaction:\n  selectors:\n    - \".user-email\"\n    - \"[data-sensitive]\"\n  secrets:\n    - \"\\\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\\\.[A-Z]{2,}\\\\b\"\n```\n\n### Branding\n\n```yaml\nmeta:\n  branding:\n    logo: \"./assets/logo.png\"\n    colors:\n      primary: \"#3B82F6\"\n      background: \"#000000\"\n```\n\n## Architecture\n\n```\n                    ┌──────────────┐\n                    │  YAML Spec   │\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │ Spec Loader  │  Zod validation + defaults\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │   Runner     │  Spawn dev server, healthcheck\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │   Playback   │  Cursor animation, typing, pacing\n                    │   Engine     │  Playwright browser automation\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │   Capture    │  Video recording + event log\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │  Timeline    │  Intro/outro, chapters, callouts\n                    │  Builder     │  Dead-time compression\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │   FFmpeg     │  Overlays, fades, final MP4\n                    │  Renderer    │\n                    └──────┬───────┘\n                           │\n                    ┌──────▼───────┐\n                    │  Narration   │  TTS + VTT/SRT subtitles\n                    │  (optional)  │\n                    └──────────────┘\n```\n\n### Project Structure\n\n```\nsrc/\n  cli.ts              # CLI entry point\n  index.ts            # Public API exports\n  spec/               # YAML parsing + Zod validation\n  runner/             # Dev server lifecycle\n  playback/           # Cursor, typing, pacing engine\n  capture/            # Playwright video recording\n  editor/             # Timeline + ffmpeg renderer\n  narration/          # TTS providers + subtitles\n  redaction/          # Blur + secret scanning\n  utils/              # Logger, process helpers\ntests/                # 172 tests across 13 suites\nexamples/             # Example specs + demo apps\n```\n\n## Development\n\n```bash\npnpm build          # Compile TypeScript\npnpm test           # Run 172 tests\npnpm lint           # ESLint\npnpm format         # Prettier check\npnpm typecheck      # tsc --noEmit\npnpm validate       # Run everything\n```\n\nSee [CONTRIBUTING.md](CONTRIBUTING.md) for setup instructions and development workflow.\n\n## License\n\n[MIT](LICENSE) — use it however you want.\n"
